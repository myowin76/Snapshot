
<%= form_tag root_path, :id=>"search_form", remote: true do %>
  <div class="box">
    <h4>Filter by</h4>
      <fieldset>
        <button type="submit" class="btn btn-danger clear-form">
          <i class="icon-refresh icon-white"></i> Clear
        </button>
        <button type="submit" class="btn btn-primary">
          <i class="icon-search icon-white"></i> Search
        </button>
      </fieldset>  
      <fieldset>
        <%= label_tag "Country" %>
        <% if params[:search] && params[:search][:country_id] && params[:search][:country_id] %>
          <%= collection_select(:search, :country_id, @countries, :id, :name, {:selected => params[:search][:country_id]}) %>
        <% else %>
          <%= collection_select(:search, :country_id, @countries, :id, :name, :prompt => 'All')  %>
          <%#= collection_select(:search, :country_id, @countries, :id, :name), { :prompt => 'All' } %>
        <% end %>  
      </fieldset>
  </div>    
  <div class="accordion" id="accordion2">
    <div class="accordion-group">
      <div class="accordion-heading">
        <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#sector-accord">
          Sectors <i class="icon-plus pull-right"></i>
        </a>
      </div>
      <div id="sector-accord" class="accordion-body collapse">
        <div class="accordion-inner">
          <% for sector in @sectors %>
            <% if params[:search] && params[:search][:sectors] && params[:search][:sectors].include?(sector.id.to_s) %>
              <%= label_tag "search[sectors][#{sector.id}]" do %>
                <%= check_box_tag "search[sectors][]", sector.id, true, :id => "search_sectors_#{sector.id}" %>
                <%= sector.name %>
              <% end %>  
            <% else %>  
              <%= label_tag "search[sectors][#{sector.id}]" do %>
                <%= check_box_tag "search[sectors][]", sector.id, false, :id => "search_sectors_#{sector.id}" %>
                <%= sector.name %>
              <% end %>  
            <% end %>  
            
          <% end %>  
        </div>
      </div>
    </div>
    
    <div class="accordion-group">
      <div class="accordion-heading">
        <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#retailers-accord">
          Retailers <i class="icon-plus pull-right"></i>
        </a>
      </div>
      <div id="retailers-accord" class="accordion-body collapse">
        <div class="accordion-inner">
          <%= render :partial => 'retailer_view', :locals => {:retailers => @retailers}%>
        </div>
      </div>
    </div>
    <div class="accordion-group">
      <div class="accordion-heading">
        <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#categories">
          Categories <i class="icon-plus pull-right"></i>
        </a>
      </div>
      <div id="categories" class="accordion-body collapse">
        <div class="accordion-inner">
          <% for category in @categories %>
            <% if params[:search] && params[:search][:category] && params[:search][:category].include?(category.id.to_s) %>
              <%= label_tag "search[category][#{category.id}]", category.id do %>
                <%= check_box_tag "search[category][]", category.id, true, :id => "search_category_#{category.id}" %>
                <%= category.name %>
              <% end %>    
            <% else %>
              <%= label_tag "search[category][#{category.id}]" do %>
                <%= check_box_tag "search[category][]", category.id, false, :id => "search_category_#{category.id}" %>
                <%= category.name %>
              <% end %>  
            <% end %>
            
          <% end %>
        </div>
      </div>
    </div>
    <div class="accordion-group">
      <div class="accordion-heading">
        <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#brands">
          Brands <i class="icon-plus pull-right"></i>
        </a>
      </div>
      <div id="brands" class="accordion-body collapse">
        <div class="accordion-inner">
          <% for brand in @brands %>
            <% if params[:search] && params[:search][:brands] && params[:search][:brands].include?(brand.id.to_s) %>
              <%= label_tag "search[brands][#{brand.id}]" do %>
                <%= check_box_tag "search[brands][]", brand.id, :check => "checked", :id => "search_brands_#{brand.id}" %>
                <%= brand.name %><br />
              <% end %>  
            <% else %>  
              <%= label_tag "search[brands][#{brand.id}]" do %>
                <%= check_box_tag "search[brands][]", brand.id, false, :id => "search_brands_#{brand.id}" %>
                <%= brand.name %><br />
              <% end %>  
            <% end %>  
          <% end %>  
        </div>
      </div>
    </div>
    <div class="accordion-group">
      <div class="accordion-heading">
        <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#dates">
          Dates <i class="icon-plus pull-right"></i>
        </a>
      </div>
      <div id="dates" class="accordion-body collapse">
        <div class="accordion-inner">
          <fieldset>
            <%= label_tag "From" %>
            <% if params[:search] && params[:search][:fromDate] && params[:search][:fromDate] %>
              <%= text_field_tag "search[fromDate]", params[:search][:fromDate] %>  
            <% else %>
              <%= text_field_tag "search[fromDate]" %>
            <% end %>
          </fieldset>
          <fieldset>
            <%= label_tag "To" %>
            <% if params[:search] && params[:search][:toDate] && params[:search][:toDate] %>
              <%= text_field_tag "search[toDate]", params[:search][:toDate] %>  
            <% else %>
              <%= text_field_tag "search[toDate]" %>
            <% end %>  
          </fieldset>
        </div>
      </div>
    </div>
    <div class="accordion-group">
      <div class="accordion-heading">
        <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#channel">
          Channel / Platform <i class="icon-plus pull-right"></i>
        </a>
      </div>
      <div id="channel" class="accordion-body collapse">
        <div class="accordion-inner">
          <% for channel in @channels %>
            <% if params[:search] && params[:search][:pchannel] && params[:search][:pchannel].include?(channel.id.to_s) %>
              <%= label_tag "search[pchannel][#{channel.id}]" do %>
                <%= check_box_tag "search[pchannel][]", channel.id, true, :id => "search_pchannel_#{channel.id}" %>
                <%= channel.name %>
              <% end %>  
            <% else %>
              <%= label_tag "search[pchannel][#{channel.id}]" do %>
                <%= check_box_tag "search[pchannel][]", channel.id, false, :id => "search_pchannel_#{channel.id}" %>
                <%= channel.name %>
              <% end %>
            <% end %>
          <% end %>
        </div>
      </div>
    </div>
    <div class="accordion-group">
      <div class="accordion-heading">
        <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#env_type">
          Environment Types <i class="icon-plus pull-right"></i>
        </a>
      </div>
      <div id="env_type" class="accordion-body collapse">
        <div class="accordion-inner">
          <% for env_type in @env_types %>
            <% if params[:search] && params[:search][:env_types] && params[:search][:env_types].include?(env_type.id.to_s) %>
              <%= label_tag "search[env_types][#{env_type.id}]" do %>
                <%= check_box_tag "search[env_types][]", env_type.id, :check => "checked", :id => "search_env_types_#{env_type.id}" %>
                <%= env_type.name %>
              <% end %>  
            <% else %>
              <%= label_tag "search[env_types][#{env_type.id}]" do %>
                <%= check_box_tag "search[env_types][]", env_type.id, false, :id => "search_env_types_#{env_type.id}" %>
                <%= env_type.name %>
              <% end %>  
            <% end %>  
          <% end %>  
        </div>
      </div>
    </div>
    <div class="accordion-group">
      <div class="accordion-heading">
        <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#store-formats">
          Store Formats <i class="icon-plus pull-right"></i>
        </a>
      </div>
      <div id="store-formats" class="accordion-body collapse">
        <div class="accordion-inner">
          <% for sf in @store_formats %>
            <% if params[:search] && params[:search][:sformats] && params[:search][:sformats].include?(sf.id.to_s) %>
              <%= label_tag "search[sformats][#{sf.id}]" do %>
                <%= check_box_tag "search[sformats][]", sf.id, true, :id => "search_sectors_#{sf.id}" %>
                <%= sf.name %>
              <% end %>  
            <% else %> 
              <%= label_tag "search[sformats][#{sf.id}]" do %> 
                <%= check_box_tag "search[sformats][]", sf.id, false, :id => "search_sectors_#{sf.id}" %>
                <%= sf.name %>
              <% end %>  
            <% end %>
          <% end %>  
        </div>
      </div>
    </div>
    <div class="accordion-group">
      <div class="accordion-heading">
        <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#media_location">
          Media Locations <i class="icon-plus pull-right"></i>
        </a>
      </div>
      <div id="media_location" class="accordion-body collapse">
        <div class="accordion-inner">
          <% for media_location in @media_locations %>
            <% if params[:search] && params[:search][:media_loc] && params[:search][:media_loc].include?(media_location.id.to_s) %>
              <%= label_tag "search[media_loc][#{media_location.id}]" do %>    
                <%= check_box_tag "search[media_loc][]", media_location.id, :check => "checked", :id => "search_media_loc_#{media_location.id}" %>
                <%= media_location.name %><br />
              <% end %>    
            <% else %>
              <%= label_tag "search[media_loc][#{media_location.id}]" do %>      
                <%= check_box_tag "search[media_loc][]", media_location.id, false, :id => "search_media_loc_#{media_location.id}" %>
                <%= media_location.name %><br />
              <% end %>    
            <% end %>  
          <% end %>  
        </div>
      </div>
    </div>
    <div class="accordion-group">
      <div class="accordion-heading">
        <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#media_vehicle">
          Media Vehicles <i class="icon-plus pull-right"></i>
        </a>
      </div>
      <div id="media_vehicle" class="accordion-body collapse">
        <div class="accordion-inner">
          <% for media_vehicle in @media_vehicles %>
            <% if params[:search] && params[:search][:media_v] && params[:search][:media_v].include?(media_vehicle.id.to_s) %>
              <%= label_tag "search[media_v][#{media_vehicle.id}]" do %>    
                <%= check_box_tag "search[media_v][]", media_vehicle.id, :check => "checked", :id => "search_media_v_#{media_vehicle.id}" %>
                <%= media_vehicle.name %><br />
              <% end %>    
            <% else %>
              <%= label_tag "search[media_v][#{media_vehicle.id}]" do %>      
                <%= check_box_tag "search[media_v][]", media_vehicle.id, false, :id => "search_media_v_#{media_vehicle.id}" %>
                <%= media_vehicle.name %><br />
              <% end %>    
            <% end %>  
            
          <% end %>  
        </div>
      </div>
    </div>
    <div class="accordion-group">
      <div class="accordion-heading">
        <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#media_type">
          Media Types <i class="icon-plus pull-right"></i>
        </a>
      </div>
      <div id="media_type" class="accordion-body collapse">
        <div class="accordion-inner">
          <% for media_type in @media_types %>
            <% if params[:search] && params[:search][:media_type] && params[:search][:media_type].include?(media_type.id.to_s) %>
              <%= label_tag "search[media_type][#{media_type.id}]" do %>    
                <%= check_box_tag "search[media_type][]", media_type.id, :check => "checked", :id => "search_media_type_#{media_type.id}" %>
                <%= media_type.name %><br />
              <% end %>  
            <% else %>
              <%= label_tag "search[media_type][#{media_type.id}]" do %>      
                <%= check_box_tag "search[media_type][]", media_type.id, false, :id => "search_media_type_#{media_type.id}" %>
                <%= media_type.name %><br />
              <% end %>    
            <% end %>  
            
          <% end %>  
        </div>
      </div>
    </div>
    <div class="accordion-group">
      <div class="accordion-heading">
        <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#promo_type">
          Promotion Types <i class="icon-plus pull-right"></i>
        </a>
      </div>
      <div id="promo_type" class="accordion-body collapse">
        <div class="accordion-inner">
          <% for promo_type in @promo_types %>
            <% if params[:search] && params[:search][:promo_types] && params[:search][:promo_types].include?(promo_type.id.to_s) %>
              <%= label_tag "search[promo_types][#{promo_type.id}]" do %>  
                <%= check_box_tag "search[promo_types][]", promo_type.id, :check => "checked", :id => "search_promo_types_#{promo_type.id}"  %>
                <%= promo_type.name %><br />
              <% end %>  
            <% else %>
              <%= label_tag "search[promo_types][#{promo_type.id}]" do %>    
                <%= check_box_tag "search[promo_types][]", promo_type.id, false, :id => "search_promo_types_#{promo_type.id}" %>
                <%= promo_type.name %><br />
              <% end %>
            <% end %>  
            
          <% end %>  
        </div>
      </div>
    </div>
    <div class="accordion-group">
      <div class="accordion-heading">
        <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#promo_cal">
          Promotion Calendars <i class="icon-plus pull-right"></i>
        </a>
      </div>
      <div id="promo_cal" class="accordion-body collapse">
        <div class="accordion-inner">
          <% for promo_calendar in @promo_calendars %>
            <% if params[:search] && params[:search][:promo_cal] && params[:search][:promo_cal].include?(promo_calendar.id.to_s) %>
              <%= label_tag "search[promo_cal][#{promo_calendar.id}]" do %>    
                <%= check_box_tag "search[promo_cal][]", promo_calendar.id, :check => "checked", :id => "search_promo_cal_#{promo_calendar.id}"  %>
                <%= promo_calendar.name %>
              <% end %>
            <% else %>
              <%= label_tag "search[promo_cal][#{promo_calendar.id}]" do %>  
                <%= check_box_tag "search[promo_cal][]", promo_calendar.id, false, :id => "search_promo_cal_#{promo_calendar.id}" %>
                <%= promo_calendar.name %>
              <% end %>
            <% end %>
          <% end %>  
        </div>
      </div>
    </div>
    <div class="accordion-group">
      <div class="accordion-heading">
        <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#geolocation">
          Location Search <i class="icon-plus pull-right"></i>
        </a>
      </div>
      <div id="geolocation" class="accordion-body collapse">
        <div class="accordion-inner">
          <fieldset>
            <%= label_tag "Location" %>
            <% if params[:search] && params[:search][:location] && params[:search][:location] %>
              <%= text_field_tag 'search[location]', params[:search][:location] %>
            <% else %>
              <%= text_field_tag 'search[location]'%>
              <%#= text_field_tag 'search[location]', '', :autocomplete => photo_autocomplete_store_location_path %>
            <% end %>
            <span>e.g Edinburgh, EH3, etc</span>
          </fieldset>
        </div>
      </div>
    </div>
    <div class="accordion-group">
      <div class="accordion-heading">
        <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#themes">
          Themes <i class="icon-plus pull-right"></i>
        </a>
      </div>
      <div id="themes" class="accordion-body collapse">
        <div class="accordion-inner">
          <% for theme in @themes %>
            <% if params[:search] && params[:search][:theme] && params[:search][:theme].include?(theme.id.to_s) %>
              <%= label_tag "search[theme][#{theme.id}]" do %>
                <%= check_box_tag "search[theme][]", theme.id, :check => "checked", :id => "search_theme_#{theme.id}" %>
                <%= theme.name %><br />
              <% end %>
            <% else %>  
              <%= label_tag "search[theme][#{theme.id}]" do %>
                <%= check_box_tag "search[theme][]", theme.id, false, :id => "search_theme_#{theme.id}" %>
                <%= theme.name %><br />
              <% end %>  
            <% end %>  
          <% end %>  
        </div>
      </div>
    </div>
    
</div> <!-- ACCORDION ENDS HERE -->

<div class="box">
  <fieldset>  
    <%#= submit_tag "Search", :name => nil, :class=> 'btn btn-primary' %>
    <button type="submit" class="btn btn-primary">
      <i class="icon-search icon-white"></i> Search
    </button>
    <button type="submit" class="btn btn-danger clear-form">
      <i class="icon-refresh icon-white"></i> Clear
    </button>      
    <%#= link_to "save search test", new_save_search_path, remote: true %>
    </fieldset>
</div>    
<% end %>
<%#= link_to "Submit", root_path(params[:search]) %>
