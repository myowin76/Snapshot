<% content_for :head do %>
    <script src="https://maps.googleapis.com/maps/api/js?sensor=false"></script>
    <script>
      $(function(){
          
        var map;
        function initialize() {
          var mapOptions = {
            zoom: 15,
            mapTypeId: google.maps.MapTypeId.ROADMAP
          };
            map = new google.maps.Map(document.getElementById('map_canvas'),
              mapOptions);
            

            var points =  [
              <% @stores.each do |store| %>
                {
                  latitude: <%= store.latitude %>
                  longitude: <%= store.longitude %>
                }
            
              <% end %>       
            ];
            for (var i=0; i< points.length; i++) {
              var marker = new google.maps.Marker({
                position: new google.maps.LatLng(points[i].latitude , points[i].longitude );
                map: map,
                title: 'Hello World!'
              });
            }
             
            
        }

        google.maps.event.addDomListener(window, 'load', initialize);

      });
    </script>
<% end %>          

<h1>Listing stores</h1>
<%= link_to 'New Store', new_store_path %>
<table id="tbl-stores">
  <thead>
  <tr>
    <th>Name</th>
    <th>Address</th>
    <th>Address2</th>
    <th>Postcode</th>
    <th>Store format</th>
    <th>Retailer</th>
    <!--th>Longitude</th>
    <th>Latitude</th-->
    <th>sector</th>
    <th>Description</th>
    <th></th>
    <th></th>
    <th></th>
  </tr>
</thead>
<tbody>
<% @stores.each do |store| %>
  <tr>
    <td><%= store.name %></td>
    <td><%= store.address %></td>
    <td><%= store.address2 %></td>
    <td><%= store.postcode %></td>
    <td><%= store.store_format.name %></td>
    <td><%= store.retailer.name %></td>
    <td><%= store.retailer.sector.name %></td>
    <td><%= store.longitude %></td>
    <!--td><%= store.latitude %></td-->
    <!--td><%= store.description %></td-->
    <td><%= link_to 'Show', store %></td>
    <td><%= link_to 'Edit', edit_store_path(store) %></td>
    <td><%= link_to 'Destroy', store, method: :delete, data: { confirm: 'Are you sure?' } %></td>
  </tr>
<% end %>
</tbody>
</table>

<br />



<div id="map_canvas" style="width: 565px; height: 350px"></div> 


